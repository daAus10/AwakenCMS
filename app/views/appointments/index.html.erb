<!-- Add the CSS styles here or include it in your stylesheets -->
<style>
    /* Style the tab */
    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        width: 70vw;
        background-color: #f1f1f1;
    }

    /* Style the buttons that are used to open the tab content */
    .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
    }

    /* Change background color of buttons on hover */
    .tab button:hover {
        background-color: #ddd;
    }

    /* Create an active/current tablink class */
    .tab button.active {
        background-color: #ccc;
    }

    /* Style the tab content */
    .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
    }
</style>
<div id="flex">
<%= render 'layouts/navbar' %>

  <div id="right">
<!-- Tab links -->
<div class="tab">
  <button class="tablinks" onclick="openTab(event, 'Today')">Today</button>
  <button class="tablinks" onclick="openTab(event, 'Upcoming')">Upcoming</button>
  <button class="tablinks" onclick="openTab(event, 'Past')">Past</button>
</div>

<!-- Tab content -->
<div id="Today" class="tabcontent">
  <h3>Today's Appointments</h3>
  <% @today_appointments.each do |appointment| %>
    <%= render appointment %>
    <p>
      Time: <%= appointment.time %>
    </p>

    <% appointment.orderables.each do |orderable| %>
      <li><%= "#{orderable.product.name} - #{orderable.quantity}" %></li>
    <% end %>

    <p>
      Assign to employee:
      <%= form_with(url: assign_employee_appointment_path(appointment), method: :patch, local: true, html: { onchange: 'this.form.submit()' }) do |form| %>
        <%= form.collection_select(:employee_id, @employees, :id, :name, { selected: appointment.employee_id, prompt: "Assigned to: #{appointment.employee&.name || 'None'}" }, { onchange: 'this.form.submit()' }) %>
      <% end %>
    </p>

    <p>
      <%= link_to "Show this appointment", appointment %>
    </p>

  <% end %>
</div>

<div id="Upcoming" class="tabcontent">
  <h3>Upcoming Appointments</h3>
  <% @upcoming_appointments.each do |appointment| %>
    <%= render appointment %>
    <p>
      Time: <%= appointment.time %>
    </p>

    <% appointment.orderables.each do |orderable| %>
      <li><%= "#{orderable.product.name} - #{orderable.quantity}" %></li>
    <% end %>

    <p>
      Assign to employee:
      <%= form_with(url: assign_employee_appointment_path(appointment), method: :patch, local: true, html: { onchange: 'this.form.submit()' }) do |form| %>
        <%= form.collection_select(:employee_id, @employees, :id, :name, { selected: appointment.employee_id, prompt: "Assigned to: #{appointment.employee&.name || 'None'}" }, { onchange: 'this.form.submit()' }) %>
      <% end %>
    </p>

    <p>
      <%= link_to "Show this appointment", appointment %>
    </p>

<% end %>
</div>

<div id="Past" class="tabcontent">
  <h3>Past Appointments</h3>
  <% @past_appointments.each do |appointment| %>
    <%= render appointment %>
    <p>
      Time: <%= appointment.time %>
    </p>

    <% appointment.orderables.each do |orderable| %>
      <li><%= "#{orderable.product.name} - #{orderable.quantity}" %></li>
    <% end %>

    <p>
      Assign to employee:
      <%= form_with(url: assign_employee_appointment_path(appointment), method: :patch, local: true, html: { onchange: 'this.form.submit()' }) do |form| %>
        <%= form.collection_select(:employee_id, @employees, :id, :name, { selected: appointment.employee_id, prompt: "Assigned to: #{appointment.employee&.name || 'None'}" }, { onchange: 'this.form.submit()' }) %>
      <% end %>
    </p>

    <p>
      <%= link_to "Show this appointment", appointment %>
    </p>

<% end %>
</div>
  </div>
</div>


<script>
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += "active";
    }

    // Get the element with id="defaultOpen" and click on it
    document.addEventListener("DOMContentLoaded", function() {
        document.querySelector(".tablinks").click();
    });
</script>


















<!-- Display a green notice message if it exists -->
<!--<p style="color: green"><%#= notice %></p>-->

<!--<div id="flex">-->
  <%#= render 'layouts/navbar' %>

<!--  <div id="right">-->
<!--    <h1>Appointments</h1>-->

<!--    <div id="appointments">-->
      <%# @appointments.each do |appointment| %>
        <%#= render appointment %>

<!--        <p>-->
<!--          Time: <%#= appointment.time %>-->
<!--        </p>-->

        <%# appointment.orderables.each do |orderable| %>
<!--          <li><%#= "#{orderable.product.name} - #{orderable.quantity}" %></li>-->
        <%# end %>



<!--        <p>-->
<!--          Assign to employee:-->
          <%#= form_with(url: assign_employee_appointment_path(appointment), method: :patch, local: true, html: { onchange: 'this.form.submit()' }) do |form| %>
            <%#= form.collection_select(:employee_id, @employees, :id, :name, { selected: appointment.employee_id, prompt: "Assigned to: #{appointment.employee&.name || 'None'}" }, { onchange: 'this.form.submit()' }) %>
          <%# end %>
<!--        </p>-->


<!--       Commented out code for another alternative option to assign appointment to an employee -->
<!--        <p>-->
<!--          Assign to employee:-->
          <%#= form_with(url: assign_employee_appointment_path(appointment), method: :patch, local: true) do |form| %>
            <%#= form.collection_select(:employee_id, @employees, :id, :name, prompt: "Select an employee") %>
            <%#= form.submit "Assign" %>
          <%# end %>
<!--        </p>-->


<!--        <p>-->
          <%#= link_to "Show this appointment", appointment %>
<!--        </p>-->
      <%# end %>
<!--    </div>-->

<!--    Commented out code for a link to create a new appointment -->
    <%#= link_to "New appointment", new_appointment_path %>
<!--  </div>-->
<!--</div>-->
