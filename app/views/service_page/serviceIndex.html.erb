<%#= javascript_include_tag 'cart' %>

<% if @service_data_title.any? %>

  <h2><%= @service_data_title.first %></h2>

<% else %>
  <h2>Title</h2>
<% end %>

<% if @service_data_desc.any? %>
  <p><%= @service_data_desc.first %></p>
<% else %>
  <p>Description</p>
<% end %>

<%= form_tag kart_add_path, method: :post, remote: true do %>
  <% @product_cat.each do |categories| %>
    <div>
      <%= categories.title  %>
      <hr>
      <% categories.products.each do |items| %>
        <label>
          <%= check_box_tag "service_item_ids[]", items.id, false , onchange:"updateCartCount(this)" %>
          <%#= check_box_tag "service_item_ids[]", items.id %>
          <%= items.name + " "  + items.price.to_s  + " "  + items.description %>
        </label>
        <br>
        <br>
      <% end %>
    </div>
  <% end %>
  <%= submit_tag "Add Selected Items to Cart" %>
<% end %>

<%# if @service_data_title.any? %>

<!--  <h2><%#= @service_data_title.first %></h2>-->

<%# else %>
<!--  <h2>Title</h2>-->
<%# end %>

<%# if @service_data_desc.any? %>
<!--  <p><%#= @service_data_desc.first %></p>-->
<%# else %>
<!--  <p>Description</p>-->
<%# end %>

<%#= form_tag kart_add_path, method: :post, remote: true do %>
  <%# @product_cat.each do |categories| %>
<!--    <div>-->
      <%#= categories.title  %>
<!--      <hr>-->
      <%# @products.each do |items| %>
<!--        <label>-->
          <%#= check_box_tag "service_item_ids[]", items.id, false , onchange:"updateCartCount(this)" %>
          <%#= check_box_tag "service_item_ids[]", items.id %>
          <%#= items.name + " "  + items.price.to_s  + " "  + items.description %>
<!--        </label>-->
<!--        <br>-->
<!--        <br>-->
      <%# end %>
<!--    </div>-->
  <%# end %>
  <%#= submit_tag "Add Selected Items to Cart" %>
<%# end %>

<script>
    document.addEventListener("turbo:load", function() {
        var checkboxes = document.querySelectorAll('input[type=checkbox]');
        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                var cartCount = document.getElementById('cart-count');
                var count = parseInt(cartCount.innerHTML);
                if (this.checked) {
                    count += 1;
                } else {
                    if (count > 0) {
                        count -= 1;
                    } else {
                        count = 0;
                    }
                }
                cartCount.innerHTML = count.toString() + " item(s) in cart";
            });
        });
    });
</script>
<script>


    document.addEventListener("turbo:load", function() {
        var checkboxes = document.querySelectorAll('input[type=checkbox]');
        var cartCount = document.getElementById('cart-count');
        var count = <%= @kart.quantity %>;

        checkboxes.forEach(function(checkbox) {
            checkbox.addEventListener('change', function() {
                cartCount.innerHTML = <%= @kart.quantity %>;
            });
        });
    });

</script>


<%# @product_cat.each do |category| %>
<!--  <div>-->
    <%#= category.title %>
<!--    <hr>-->
    <%# category.products.each do |product| %>
      <%#= form_with(url: kart_add_path) do |f| %>
        <%#= f.hidden_field :id, value: product.id %>
        <%#= f.check_box :quantity, {class: 'product-checkbox'}, "1", "0" %>
        <%#= f.label :quantity, "#{product.name} (#{product.price})" %>
      <%# end %>
    <%# end %>
<!--  </div>-->
<%# end %>

<%# @service_cat.each do |categories| %>
<!--  <div>-->
    <%#= categories.title  %>
<!--    <hr>-->
    <%# @service_items.each do |items| %>
    <%#= items.service_name , items.time, items.price, items.description %>
      <%#= items.service_name + " " + items.time.to_s + " " + items.price.to_s + " " + items.description %>
      <%#= items.name + " "  + items.price.to_s  + " "  + items.description %>
<!--      <br>-->
<!--      <br>-->
  <%# end %>
<!--  </div>-->
<%# end %>


<%# @service_cat.each do |categories| %>
<!--  <div>-->
    <%#= categories.title  %>
<!--    <hr>-->
    <%# categories.service_items.each do |items| %>
      <%#= items.service_name + " " + items.time.to_s + " " + items.price.to_s + " " + items.description %>
    <%# end %>
<!--  </div>-->
<%# end %>
